<!DOCTYPE html>
<html lang="en-US">
 <head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
  <link rel="icon" type="image/gif" href="/img/cxc.gif">
  <title>Searching the 'What is Chandra doing now?' site</title>
  <link href="/css/main.css" type="text/css" rel="stylesheet" title="Default"
        media="all">
  <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
  <link rel="stylesheet"
        href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <link href="/css/search.css" type="text/css" rel="stylesheet">
 </head>
 <body>
  <nav role="navigation">
   <ul>
    <li><a id='home'  href="/index.html">What is Chandra doing now?</a></li>
    <li><a id='sched' href="/schedule/index.html">Schedule</a></li>
    <li><a id='expl'  class='chosen' href="/search/index.html">Explore</a></li>
    <li><a id='about' href="/about/index.html">About</a></li>
    <li><a id='insts' href="/about/instruments.html">Instruments</a></li>
    <li><a id='views' href="/about/views.html">Views</a></li>
   </ul>
  </nav>

  <div id="explorebox">
    <h2>Explore the observations made by Chandra</h2>

    <!-- TODO: would like to link to help information on
         proposal categories or SIMBAD data types -->
    <div class="explanation">
      Here are some ways to explore the observations
      performed by Chandra. Many are just different ways to view
      the schedule - by restricting to a subset of the observations -
      but there are also different views of the data (e.g. the
      calendar view) or how the data are linked (such as how
      the proposal categories are related to the SIMBAD data types):
    </div>

    <ul>

      <li>
        explore the
        <a href="/search/timeline/">Chandra observing timeline</a>,
        which - unlike many of the following views - allows you
        to filter the data, using
        <a href="https://en.wikipedia.org/wiki/Faceted_search">faceted
          browsing</a>,
      </li>
      
      <li>
        <a href="/search/calendar/">a calendar view</a>,
        which can be compared to the
        <a href="/search/exposures/">exposure-time breakdown</a>,
        to see how the observations are spread throughout the observing
        cycle,
      </li>

      <li><a href="/search/instrument/">by instrument</a>,</li>
      <li>a look at <a href="/search/breakdown/">how the time is spent on each instrument</a>,</li>
      <li>by viewing the
        <a href="/search/dtype/">full SIMBAD object hierarchy</a>
        or 
        <a href="/search/type/">treating them individually</a>,
      </li>
      <li>by <a href="/search/constellation/">constellation</a>,</li>
      <li>by proposal <a href="/search/category/">category</a>
        or <a href="/search/proptype/">type</a>,</li>
      <li>by what sort of <a href="/search/turnaround/">turnaround time</a>
        or <a href="/search/constraints/">constraints</a>
        was needed for the observation (if any),</li>
      <li>the <a href="/search/joint/">observations done jointly with other telescopes</a>,</li>
      <li>and looking at <a href="/search/mappings/">how the proposal categories
      and SIMBAD object types are related</a>.</li>
    </ul>

  <div>
    <form action="/search/name" method="get">
      <label for="namesearch">
        You can also try searching by target name:
      </label>
      <input type="text" autocomplete="off" id="namesearch" name="target" />
    </form>
  </div>

  <div>
    <form action="/search/proposal" method="get">
      <label for="propnamesearch">
        How about searching proposals by name?
      </label>
      <input type="text" autocomplete="off" id="propnamesearch" name="target" />
    </form>
  </div>

  <p>
    The text search will match your input against the schedule, and provide
    suggestions, but this only happens after three or more characters
    are entered. The searches are case insensitive and
    exact, so you can not search for all
    observations of targets containing the string <tt>NGC</tt>.
    Note that there is an issue with spaces in the text searches; ideally the names
    would be normalized (or the search would be), but at present
    they are not, so the results of searching for
    <tt>NGC   404</tt>, <tt>NGC 404</tt>, or
    <tt>NGC404</tt> will be different.
  </p>
  </div>
  <script>
    // from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent
function fixedEncodeURIComponent(str) {
  return encodeURIComponent(str).replace(/[!'()*]/g, function(c) {
    return '%' + c.charCodeAt(0).toString(16);
  });
}

function selected(prefix) {
    return function(event, ui) {
    // skip if the event has been cancelled; for now only support
    // event=Enter, as not sure what the event types can be, but
    // this may need to be changed (e.g. touch screens).
    //
    if (event.key == "Enter") {
      var term = event.target.value;
      window.location = prefix + fixedEncodeURIComponent(term);
      }
    };
}
    
    $("#namesearch").autocomplete({
    minLength: 3,
    source: '/api/search/name',
    close: selected("/search/name?target=")
    });

    /* the UI is a bit confusing here since the text gets replaced by
       the number; there must be a better way */
    $("#propnamesearch").autocomplete({
    minLength: 3,
    source: function(request, response) {
    $.ajax({
          url: "/api/search/proposal",
          dataType: "json",
          data: {
            term: request.term
          },
          success: function(data) {
    response(data.map(function(d) {
      return { label: d.title, value: d.number };
    }));
          },
          error: function(data) {
            /* not sure what the expected behavior here is */
            response([]);
          },
        });
    },
    close: selected("/proposal/")
    });
</script>
  
  <p id="banner">
    The 'What is Chandra doing now?' web site is developed by
    the Science Data Systems group of the
    <a href="http://chandra.si.edu/">Chandra X-ray Center</a>.
    The information on this site is intended for
    educational purposes and should not be relied on for
    scientific use.
  </p>
 </body>
</html>
